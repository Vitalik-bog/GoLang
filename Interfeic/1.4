package main

import (
    "fmt"
    "net/http"
)

// –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–∑ –ø–∞–∫–µ—Ç–∞ http
type Handler interface {
    ServeHTTP(http.ResponseWriter, *http.Request)
}

// –ù–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
type HomeHandler struct{}

func (h HomeHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "üè† Welcome to our website!")
}

// –î—Ä—É–≥–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
type APIHandler struct {
    Version string
}

func (a APIHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "üöÄ API Version: %s", a.Version)
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
type UserHandler struct {
    Database string // –∏–º–∏—Ç–∞—Ü–∏—è –ë–î
}

func (u UserHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {
    switch r.Method {
    case "GET":
        fmt.Fprintf(w, "üë§ User data from %s", u.Database)
    case "POST":
        fmt.Fprintf(w, "‚úÖ User created in %s", u.Database)
    default:
        http.Error(w, "Method not allowed", http.StatusMethodNotAllowed)
    }
}

func main() {
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤
    http.Handle("/", HomeHandler{})
    http.Handle("/api", APIHandler{Version: "v1.0"})
    http.Handle("/users", UserHandler{Database: "PostgreSQL"})

    fmt.Println("Server starting on :8080")
    // http.ListenAndServe(":8080", nil)

    // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ –≤—ã–≤–µ–¥–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
    handlers := []Handler{
        HomeHandler{},
        APIHandler{Version: "v1.0"},
        UserHandler{Database: "PostgreSQL"},
    }

    for _, handler := range handlers {
        fmt.Printf("Handler: %T\n", handler)
    }
}
